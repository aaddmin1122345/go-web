<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学生信息管理</title>
    <script src="./script/jquery-3.7.1.js"></script>
    <script src="./script/user.js"></script>
    <script>
        $(document).ready(function () {
            // 点击发送Ajax响应
            $("#btn1").click(function () {
                sendAjaxHello();
            });

            // 点击计算
            $("#btn2").click(function () {
                calculate();
            });

            // 点击登录
            // $("#btn3").click(function () {
            //     login();
            // });

            // 另外一个版本的登陆
            $("#btn4").click(function () {
                login();
            });

            // $("#btn5").click(function () {
            //     searchUser();
            // });
            //
            // $("#btn6").click(function () {
            //     UserSelect();
            // });

            // 模糊查询
            $('#getUserByUserNameBtn').click(function () {
                getUserByUserName();
            });

            // 添加学生信息
            $('#addUserForm').submit(function (event) {
                event.preventDefault();
                addUser();
            });

            // 删除学生信息
            $('#delUserBtn').click(function () {
                delUser();
            });

            $('#updateUserBtn').click(function () {
                delUser();
            });

            // $('#loginForm').click(function () {
            //     login();
            // });
        });

        function sendAjaxHello() {
            $.ajax({
                type: "POST",
                url: "/sayHello",  // 修改为与后端路由匹配的路径
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    alert(response.message);
                },
                error: function (xhr, status, error) {
                    alert("请求失败：" + error);
                }
            });
        }

        // 计算
        function calculate() {
            const par1Value = parseInt($("#par1").val());
            const par2Value = parseInt($("#par2").val());
            const dataToSend = {
                par1: par1Value,
                par2: par2Value
            };

            $.ajax({
                type: "POST",
                url: "/sum",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                data: JSON.stringify(dataToSend),
                success: function (data) {
                    $("#result").html("<h1 style='color: red;'>结果：" + data.result + "</h1>");
                },
                error: function (xhr, status, error) {
                    alert("请求失败：" + error);
                }
            });
        }

        // 用户登录验证
        // function login() {
        //     const username = $("#user").val();
        //     const password = $("#pwd").val();
        //     const dataToSend = {
        //         username: username,
        //         password: password
        //     };
        //
        //     $.ajax({
        //         type: "POST",
        //         url: "/api/login",  // 修改为与后端路由匹配的路径
        //         contentType: "application/json; charset=utf-8",
        //         dataType: "json",
        //         data: JSON.stringify(dataToSend),
        //         success: function (data) {
        //             if (data.valid)
        //                 alert("登录成功");
        //             else
        //                 alert("登录失败");
        //         },
        //         error: function (err) {
        //             alert(err);
        //         }
        //     });
        // }



        // function getStud() {
        //     let data = {
        //         ID: 0,
        //         StudID: "",
        //         Username: "",
        //         Sex: "",
        //         Email: ""
        //     };
        //
        //     $.ajax({
        //         type: "GET",
        //         url: "/api/",
        //         dataType: "json",
        //         success: function (responseData) {
        //             data = responseData;
        //             console.log("success", data);
        //             $("#stud").html("ID: " + data.ID + "<br>" +
        //                 "学生 ID: " + data.StudID + "<br>" +
        //                 "用户名: " + data.Username + "<br>" +
        //                 "性别: " + data.Sex + "<br>" +
        //                 "邮箱: " + data.Email)
        //                 .css("color", "Red");
        //         },
        //         error: function () {
        //             console.log("false");
        //         }
        //     });
        // }
        //
        // function searchUser() {
        //     let searchUser = $("#searchUser").val();
        //     $.ajax({
        //         type: "POST",
        //         url: "/api/GetUsersByStudID",
        //         data: searchUser, // 直接发送搜索关键字字符串
        //         success: function (responseData) {
        //             const data = responseData;
        //             console.log("success", data);
        //             $("#stud").html("ID: " + data.ID + "<br>" +
        //                 "学生 ID: " + data.StudID + "<br>" +
        //                 "用户名: " + data.Username + "<br>" +
        //                 "性别: " + data.Sex + "<br>" +
        //                 "邮箱: " + data.Email)
        //                 .css("color", "Red");
        //         },
        //         error: function () {
        //             console.log("false");
        //         }
        //     });
        // }


    </script>
</head>
<body>
<h1>学生信息管理</h1>

<h2>模糊查询</h2>
<input type="text" id="search" placeholder="输入用户名">
<button id="getUserByUserNameBtn">查询</button>

<table id="results" border="1">
    <tr>
        <th>ID</th>
        <th>StudID</th>
        <th>Username</th>
        <th>Sex</th>
        <th>Email</th>
    </tr>
</table>

<h2>添加学生信息</h2>
<form id="addUserForm">
    <label for="studID">StudID:</label>
    <input type="text" id="studID" required><br>
    <label for="username">用户名:</label>
    <input type="text" id="username" required><br>
    <label for="sex">性别:</label>
    <input type="text" id="sex" required><br>
    <label for="email">邮箱:</label>
    <input type="text" id="email" required><br>
    <label for="password">密码:</label>
    <input type="text" id="password" required><br>
    <button type="submit">添加</button>
</form>
<br>
<h2>删除用户</h2>
<input id="deleteUser" type="text" >
<button type="button" id="delUserBtn"> 删除 </button>
<br>
<h2>登陆</h2>

<form id="loginForm">
    <div>
        <label for="loginUserName">用户名:</label>
        <input type="text" id="loginUserName"><br>
        <label for="loginPassWord">密码:</label>
        <input type="password" id="loginPassWord"><br>
        <button type="button" onclick="login()">登录</button>
        <div id="errorInfo"></div>
    </div>
</form>



<h2>修改学生信息</h2>
<form id="updateUserForm">
    <label for="updateStudID">StudID:</label>
    <input type="text" id="updateStudID" required><br>
    <label for="updateUsername">用户名:</label>
    <input type="text" id="updateUsername" required><br>
    <label for="updateSex">性别:</label>
    <input type="text" id="updateSex" required><br>
    <label for="updateEmail">邮箱:</label>
    <input type="text" id="updateEmail" required><br>
    <button type="submit" onclick="updateUser()">修改</button>
</form>
<div id="updateErrorInfo"></div>



</body>
</html>
